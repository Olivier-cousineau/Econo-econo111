<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EconoDeal — Roadmap</title>
  <style>
    :root{
      --bg:#0f172a; --panel:#111827; --panel-2:#1f2937; --text:#e5e7eb;
      --muted:#9ca3af; --accent:#22c55e; --border:#2b3446; --radius:14px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,var(--bg),#0b1020 50%,#0a0f1a);color:var(--text)}
    header{position:sticky;top:0;z-index:20;background:rgba(15,23,42,.85);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    .row{display:flex;gap:16px;flex-wrap:wrap;align-items:center}
    .brand{display:inline-flex;align-items:center;gap:12px;padding:6px 14px;border-radius:14px;text-decoration:none;color:var(--text);background:rgba(34,197,94,.08);border:1px solid rgba(34,197,94,.35);transition:transform .2s ease,box-shadow .2s ease,background .2s ease}
    .brand:hover{transform:translateY(-1px);box-shadow:0 12px 28px rgba(34,197,94,.15);background:rgba(34,197,94,.12)}
    .brand img{width:46px;height:46px;display:block}
    .brand-text{display:flex;flex-direction:column;line-height:1.1}
    .brand-title{margin:0;font-size:18px;font-weight:700;letter-spacing:-.01em}
    .brand-tagline{font-size:11px;text-transform:uppercase;letter-spacing:.14em;color:#86efac;font-weight:600}
    .nav-button{display:inline-flex;align-items:center;justify-content:center;background:var(--panel-2);color:var(--text);border:1px solid var(--border);border-radius:10px;padding:10px 12px;text-decoration:none;transition:background .2s ease,color .2s ease}
    .nav-button:hover{background:var(--panel);color:#fff}
    .nav-button:focus{outline:2px solid var(--accent);outline-offset:1px}
    .nav-button.current{background:linear-gradient(120deg,rgba(34,197,94,.25),rgba(59,130,246,.25));border-color:rgba(34,197,94,.6)}
    .section{padding:36px 0}
    .muted{color:var(--muted)}
    .roadmap{background:linear-gradient(180deg,var(--panel),#101b2d);border:1px solid var(--border);border-radius:var(--radius);padding:22px;display:grid;gap:18px;margin-top:22px;position:relative;overflow:hidden}
    .roadmap::before{content:"Roadmap stratégique";position:absolute;top:16px;right:-80px;width:220px;text-align:center;transform:rotate(45deg);background:rgba(34,197,94,.1);border:1px solid rgba(34,197,94,.35);color:#86efac;padding:6px 0;font-size:12px;letter-spacing:.08em;text-transform:uppercase}
    .roadmap-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}
    .roadmap-card{background:var(--panel-2);border:1px solid var(--border);border-radius:12px;padding:18px;display:flex;flex-direction:column;gap:12px;position:relative;overflow:hidden}
    .roadmap-year{font-size:12px;text-transform:uppercase;letter-spacing:.08em;color:var(--muted)}
    .roadmap-year strong{display:block;font-size:20px;color:var(--text)}
    .roadmap-card ul{margin:0;padding-left:18px;display:grid;gap:6px;font-size:14px;color:var(--muted)}
    .roadmap-ai{border-left:3px solid var(--accent);padding-left:12px;background:rgba(34,197,94,.08);border-radius:8px}
    .footer{border-top:1px solid var(--border);padding:20px 0 16px;color:var(--muted);text-align:center}
    .footer-links{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;margin-top:10px;font-size:13px}
    .footer-links a{color:var(--muted);text-decoration:none;transition:color .2s ease}
    .footer-links a:hover{color:#fff}
    #registrationOverlay{position:fixed;inset:0;background:rgba(15,23,42,.94);display:flex;align-items:center;justify-content:center;padding:20px;z-index:2000}
    #registrationOverlay.hidden{display:none}
    .registration-card{background:linear-gradient(180deg,var(--panel),#101b2d);border:1px solid var(--border);border-radius:var(--radius);max-width:420px;width:100%;padding:26px;display:grid;gap:16px;box-shadow:0 24px 60px rgba(15,23,42,.5)}
    .registration-card form{display:grid;gap:12px}
    .registration-card input{width:100%;background:var(--panel-2);color:var(--text);border:1px solid var(--border);border-radius:10px;padding:10px 12px}
    .registration-card button{background:linear-gradient(120deg,rgba(34,197,94,.9),rgba(59,130,246,.85));color:#fff;border:none;font-weight:600;cursor:pointer;transition:opacity .2s ease,transform .2s ease}
    .registration-card button:hover:not(:disabled){opacity:.9;transform:translateY(-1px)}
    .checkbox-row{display:flex;gap:10px;align-items:flex-start;background:rgba(34,197,94,.08);border:1px solid rgba(34,197,94,.3);padding:12px;border-radius:10px}
    body.overlay-active{overflow:hidden}
    body.overlay-active header,body.overlay-active main,body.overlay-active .footer{filter:blur(2px);pointer-events:none;user-select:none}
    @media (max-width:600px){.roadmap::before{right:-120px}}
  </style>
</head>
<body>
  <div id="registrationOverlay" class="hidden" role="dialog" aria-modal="true" aria-labelledby="registrationTitle">
    <div class="registration-card">
      <h2 id="registrationTitle">Accès réservé aux membres</h2>
      <p class="muted" style="margin:0">Rejoignez <strong><span data-client-count>0</span></strong> partenaires et découvrez la feuille de route complète.</p>
      <form id="registrationForm">
        <div>
          <label for="fullName">Nom complet</label>
          <input id="fullName" name="fullName" type="text" placeholder="Entrez votre nom" autocomplete="name" required />
        </div>
        <div>
          <label for="email">Courriel</label>
          <input id="email" name="email" type="email" placeholder="nom@exemple.com" autocomplete="email" required />
        </div>
        <div class="checkbox-row">
          <input id="regulationCheckbox" name="regulation" type="checkbox" required />
          <label for="regulationCheckbox" style="margin:0">Je confirme avoir lu et accepté les <a href="conditions-utilisation.html" data-public-link>Conditions d'utilisation</a> et la <a href="politique-confidentialite.html" data-public-link>Politique de confidentialité</a>.</label>
        </div>
        <div class="action-stack">
          <button id="registrationSubmit" type="submit" disabled>S'inscrire et accéder</button>
          <button type="button" class="nav-button" data-public-action="close-overlay">Continuer la visite</button>
        </div>
      </form>
    </div>
  </div>
  <header>
    <div class="container row" style="justify-content:space-between">
      <div class="row" style="gap:10px;align-items:center">
        <a class="brand" href="index.html">
          <img src="assets/logo.svg" alt="EconoDeal – accélérateur de revendeurs" />
          <span class="brand-text">
            <span class="brand-title">EconoDeal</span>
            <span class="brand-tagline">Revendeur gagnant</span>
          </span>
        </a>
      </div>
      <div class="row" style="gap:12px;align-items:center">
        <a class="nav-button" href="best-deals.html" style="white-space:nowrap">Meilleurs rabais</a>
        <a class="nav-button" href="pricing.html" style="white-space:nowrap">Forfaits / prix</a>
        <a class="nav-button current" href="roadmap.html" style="white-space:nowrap">Roadmap / vision</a>
        <div class="muted">© <span id="year"></span></div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="section">
      <h2 style="margin:0 0 10px">Notre feuille de route</h2>
      <p class="muted" style="max-width:640px">Une vision triennale pour propulser EconoDeal sur la scène internationale, avec une intégration progressive de l'intelligence artificielle au cœur de nos services.</p>
      <div class="roadmap">
        <div class="roadmap-grid">
          <article class="roadmap-card">
            <div class="roadmap-year"><strong>Année 1</strong> Canada</div>
            <ul>
              <li>Consolider la couverture des détaillants nationaux.</li>
              <li>Optimiser les alertes de rabais en temps réel.</li>
              <li>Lancer des tableaux de bord régionaux bilingues.</li>
            </ul>
          </article>
          <article class="roadmap-card">
            <div class="roadmap-year"><strong>Année 2</strong> États-Unis</div>
            <ul>
              <li>Élargir le catalogue aux grandes bannières américaines.</li>
              <li>Déployer la surveillance des stocks multi-états.</li>
              <li>Introduire l'analyse prédictive des tendances d'achat.</li>
            </ul>
          </article>
          <article class="roadmap-card roadmap-ai">
            <div class="roadmap-year"><strong>Année 3</strong> Europe</div>
            <ul>
              <li>Localiser l'expérience pour les principaux marchés européens.</li>
              <li>Activer un moteur de recommandations IA multilingue.</li>
              <li>Automatiser les stratégies de prix grâce à l'apprentissage continu.</li>
            </ul>
          </article>
        </div>
      </div>
    </section>
  </main>

  <div class="container footer">
    <div>© <span id="yearFooter"></span> EconoDeal · Tous droits réservés</div>
    <div class="footer-links">
      <a href="conditions-utilisation.html" data-public-link>Conditions d'utilisation</a>
      <a href="politique-confidentialite.html" data-public-link>Politique de confidentialité</a>
      <a href="contact.html" data-public-link>Nous joindre</a>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const overlay = document.getElementById('registrationOverlay');
      const form = document.getElementById('registrationForm');
      const submitBtn = document.getElementById('registrationSubmit');
      const regulationCheckbox = document.getElementById('regulationCheckbox');
      const clientCountDisplays = Array.from(document.querySelectorAll('[data-client-count]'));
      const year = document.getElementById('year');
      const yearFooter = document.getElementById('yearFooter');
      const currentYear = new Date().getFullYear();
      if(year) year.textContent = currentYear;
      if(yearFooter) yearFooter.textContent = currentYear;

      function safeGet(key){
        try{ return localStorage.getItem(key); }
        catch(err){ console.warn('Stockage local indisponible', err); return null; }
      }

      function safeSet(key, value){
        try{ localStorage.setItem(key, value); }
        catch(err){ console.warn('Impossible d\'enregistrer les données', err); }
      }

      function parseJson(value){
        if(!value) return null;
        try{ return JSON.parse(value); }
        catch(err){ console.warn('Impossible de lire les données existantes', err); return null; }
      }

      function cleanText(value){ return typeof value === 'string' ? value.trim() : ''; }

      function getRegistrations(){
        const parsed = parseJson(safeGet('econodealRegistrations'));
        if(!Array.isArray(parsed)) return [];
        return parsed
          .filter(item => item && typeof item === 'object')
          .map(item => ({
            name: cleanText(item.name),
            email: cleanText(item.email).toLowerCase(),
            registeredAt: cleanText(item.registeredAt)
          }))
          .filter(item => item.email);
      }

      function saveRegistrations(items){ safeSet('econodealRegistrations', JSON.stringify(items)); }

      function upsertRegistration(entry){
        const collection = getRegistrations();
        const email = cleanText(entry.email).toLowerCase();
        if(!email) return;
        const normalized = {
          name: cleanText(entry.name),
          email,
          registeredAt: cleanText(entry.registeredAt)
        };
        const existingIndex = collection.findIndex(item => item.email === email);
        if(existingIndex >= 0){ collection[existingIndex] = {...collection[existingIndex], ...normalized}; }
        else{ collection.push(normalized); }
        saveRegistrations(collection);
      }

      function parseCount(value){
        const parsed = parseInt(value ?? '0', 10);
        return Number.isFinite(parsed) && parsed >= 0 ? parsed : 0;
      }

      function setClientCount(value){
        const normalized = Math.max(0, value);
        safeSet('econodealClientCount', String(normalized));
        return normalized;
      }

      function deriveClientCountFromRegistrations(){
        const registrations = getRegistrations();
        if(!registrations.length) return 0;
        const uniqueEmails = new Set();
        registrations.forEach(item => { if(item?.email) uniqueEmails.add(item.email); });
        return uniqueEmails.size;
      }

      function getClientCount(){
        const stored = parseCount(safeGet('econodealClientCount'));
        const derived = deriveClientCountFromRegistrations();
        const resolved = Math.max(stored, derived);
        if(resolved !== stored){ setClientCount(resolved); }
        return resolved;
      }

      function updateClientCountDisplays(){
        const formatter = new Intl.NumberFormat('fr-CA');
        const count = getClientCount();
        clientCountDisplays.forEach(el => { el.textContent = formatter.format(count); });
      }

      function hideOverlay(){
        if(!overlay) return;
        overlay.classList.add('hidden');
        overlay.setAttribute('aria-hidden', 'true');
        document.body.classList.remove('overlay-active');
      }

      function showOverlay(){
        if(!overlay) return;
        overlay.classList.remove('hidden');
        overlay.removeAttribute('aria-hidden');
        document.body.classList.add('overlay-active');
        updateClientCountDisplays();
      }

      updateClientCountDisplays();
      hideOverlay();
      if(safeGet('econodealClientRegistered') === 'true'){
        safeSet('econodealClientRegistered', 'true');
      }

      if(submitBtn && regulationCheckbox){
        submitBtn.disabled = !regulationCheckbox.checked;
        regulationCheckbox.addEventListener('change', () => {
          submitBtn.disabled = !regulationCheckbox.checked;
        });
      }

      if(form){
        form.addEventListener('submit', (event) => {
          event.preventDefault();
          if(!form.reportValidity()) return;
          const wasRegistered = safeGet('econodealClientRegistered') === 'true';
          if(!wasRegistered){
            const current = getClientCount();
            setClientCount(current + 1);
          }
          const payload = {
            name: (form.fullName?.value ?? '').trim(),
            email: (form.email?.value ?? '').trim(),
            consent: true,
            registeredAt: new Date().toISOString()
          };
          safeSet('econodealUser', JSON.stringify(payload));
          upsertRegistration(payload);
          safeSet('econodealClientRegistered', 'true');
          updateClientCountDisplays();
          hideOverlay();
        });
      }

      const closeOverlayBtn = document.querySelector('[data-public-action="close-overlay"]');
      if(closeOverlayBtn){
        closeOverlayBtn.addEventListener('click', () => {
          hideOverlay();
        });
      }

      const GATE_SELECTORS = [
        'a[href]:not([data-public-link])',
        'button:not([data-public-action])',
        '[role="button"]:not([data-public-action])',
        '.roadmap-card'
      ];

      function shouldGate(event){
        if(safeGet('econodealClientRegistered') === 'true') return false;
        if(document.body.classList.contains('overlay-active')) return false;
        if(event.defaultPrevented) return false;
        if(event.target.closest('#registrationOverlay')) return false;
        if(event.target.closest('[data-public-link]')) return false;
        if(event.target.closest('[data-public-action]')) return false;
        for(const selector of GATE_SELECTORS){
          if(event.target.closest(selector)){
            return true;
          }
        }
        return false;
      }

      document.addEventListener('click', (event) => {
        if(event.button !== 0) return;
        if(shouldGate(event)){
          event.preventDefault();
          event.stopPropagation();
          showOverlay();
        }
      }, true);
    });
  </script>
</body>
</html>
