# econodeal_scraper.py
from playwright.sync_api import sync_playwright

def scrape_canadian_tire_store(url):
    with sync_playwright() as p:
        browser = p.chromium.launch(headless=True)
        page = browser.new_page()
        page.goto(url, timeout=60000)
        # Attendre que les prix soient rendus dans le DOM
        page.wait_for_selector("div.nl-price__margin.nl-price--grid.nl-price--height-large.nl-price", timeout=15000)
        # Extraire tous les éléments de prix
        price_elements = page.query_selector_all("div.nl-price__margin.nl-price--grid.nl-price--height-large.nl-price")
        prices = [el.text_content().strip() for el in price_elements if el.text_content()]
        for price in prices:
            print(price)
        browser.close()

if __name__ == "__main__":
    # Remplace cette URL par celle du magasin souhaité
    store_url = "https://www.canadiantire.ca/fr/store-details/qc/ville-la-salle-qc-0230.html"
    scrape_canadian_tire_store(store_url)
